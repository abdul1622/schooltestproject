{% extends 'base.html' %}
{% block index %}
<div class="counts">
</div>
<script>
    let students = []
    let staffs = []
function userdetails() {

    fetch('https://schooltestproject.herokuapp.com/api/user-details/', {
        method: 'GET',
        headers: new Headers({
            'Authorization': 'token' + ' ' +localStorage.getItem('token'),
            'Content-Type': 'application/json',
        })
    }).then(res => {
        return res.json()
    }).then(data => {
        console.log(data)
        data.forEach((d, index) => {
            if (`${d.user_type}` == 'is_student') {
                students.push(d)
            }
            else if (`${d.user_type}` == 'is_staff') {
                staffs.push(d)
            }
            if (localStorage.getItem('user_type')=='is_admin' && data[data.length-1] == d){
            var content = ''
            content += `<h3>No.of.students : <span class='count'>${students.length}</span></h3>
            <h3>No.of.staffs : <span class='count'>${staffs.length}</span></h3>`
            document.querySelector('.counts').innerHTML = content
            }
        })
    })
} 
userdetails()
console.log(staffs,students)
</script>
{% endblock %}