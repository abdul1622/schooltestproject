{% extends 'base.html' %}
{% block index %}
<div class="counts">
</div>
<script>
function userdetails() {
    var students = 0
    var staff = 0

    fetch('https://schooltestproject.herokuapp.com/api/user-details/', {
        method: 'GET',
        headers: new Headers({
            'Authorization': 'token' + ' ' +localStorage.getItem('token'),
            'Content-Type': 'application/json',
        })
    }).then(res => {
        return res.json()
    }).then(data => {
        console.log(data)
        data.forEach((d, index) => {
            if (`${d.user_type}` == 'is_student') {
                students += 1
            }
            else if (`${d.user_type}` == 'is_staff') {
                staff += 1
            }
            var content = ''
            content += `<h3>No.of.students : <span class='count'>${staff}</span></h3>
        <h3>No.of.staffs : <span class='count'>${staff}</span></h3>`
            document.querySelector('.counts').innerHTML = content
        })
    })
} userdetails()
</script>
{% endblock %}